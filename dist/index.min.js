(function(e){"use strict";function t(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var i=t(e);var n={name:"NumberTrio",props:{value:{type:String,required:true,validator(e){return Boolean(e.match(/^\d+$/))}},position:{type:Number,required:true},count:{type:Number,required:true},padding:{type:String}},computed:{part1(){return this.parts.part1},part2(){return this.parts.part2},parts(){const e=this.value;if(this.isLast){return{part1:e,part2:""}}else{return{part1:e.substring(0,e.length-1),part2:e.substring(e.length-1)}}},isLast(){return this.position===this.count-1}}};function a(e,t,i,n,a,r,s,o,u,l){if(typeof s!=="boolean"){u=o;o=s;s=false}const p=typeof i==="function"?i.options:i;if(e&&e.render){p.render=e.render;p.staticRenderFns=e.staticRenderFns;p._compiled=true;if(a){p.functional=true}}if(n){p._scopeId=n}let c;if(r){c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext;if(!e&&typeof __VUE_SSR_CONTEXT__!=="undefined"){e=__VUE_SSR_CONTEXT__}if(t){t.call(this,u(e))}if(e&&e._registeredComponents){e._registeredComponents.add(r)}};p._ssrRegister=c}else if(t){c=s?function(e){t.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}}if(c){if(p.functional){const e=p.render;p.render=function t(i,n){c.call(n);return e(i,n)}}else{const e=p.beforeCreate;p.beforeCreate=e?[].concat(e,c):[c]}}return i}const r=n;var s=function(){var e=this;var t=e.$createElement;var i=e._self._c||t;return i("span",{staticClass:"trio"},[e.part1?i("span",[e._v(e._s(e.part1))]):e._e(),e.part2?i("span",{staticClass:"padded",style:{letterSpacing:e.padding}},[e._v(e._s(e.part2))]):e._e()])};var o=[];s._withStripped=true;const u=undefined;const l=undefined;const p=undefined;const c=false;const d=a({render:s,staticRenderFns:o},u,r,l,c,p,false,undefined,undefined,undefined);var m={name:"FormattedNumber",props:{number:{type:Number,required:true},precision:{type:Number,default:2},padding:{type:String,default:null}},computed:{isNegative(){return this.parts.isNegative},integer(){return this.parts.integer},decimal(){return this.parts.decimal},parts(){const[e,t]=this.number.toString().split(".");const i=this.number<0;return{isNegative:i,integer:i?e.substring(1):e,decimal:t}},decimalTrimmed(){const[e,t]=[this.integer,this.decimal];const i=this.precision;if(t){const n=t.substring(0,i+1-e.length);return n.match(/^0*$/)?"":n}return null},integerTrios(){return this.getTrios(this.integer)}},methods:{getTrios(e){const t=[];const i=(e.length%3-3)%3;for(let n=i;n<e.length;n+=3){const i=e.substring(n,n+3);t.push(i)}return t}},components:{NumberTrio:d}};const h=m;var f=function(){var e=this;var t=e.$createElement;var i=e._self._c||t;return i("span",{staticClass:"formatted-number"},[e.isNegative?i("span",{staticClass:"minus"},[e._v("-")]):e._e(),i("span",{staticClass:"integer"},e._l(e.integerTrios,(function(t,n){return i("NumberTrio",{key:n,attrs:{value:t,position:n,count:e.integerTrios.length,padding:e.padding}})})),1),e.decimalTrimmed?i("span",{staticClass:"point"},[e._v(".")]):e._e(),e.decimalTrimmed?i("span",{staticClass:"decimal"},[e._v(e._s(e.decimalTrimmed))]):e._e()])};var v=[];f._withStripped=true;const y=undefined;const g=undefined;const T=undefined;const _=false;const b=a({render:f,staticRenderFns:v},y,h,g,_,T,false,undefined,undefined,undefined);const w=new i["default"];const S=function(){const{port1:e,port2:t}=new MessageChannel;const i=[];e.onmessage=function(){const e=i.shift();e()};return function(e){t.postMessage(null);i.push(e)}}();async function*C(e){const t=e.getReader();while(true){const{done:e,value:i}=await t.read();if(e){break}yield i}}function*I(e,t=65536){const i=new Uint8Array(e);let n=0;while(true){const e=i.subarray(n,n+t);if(!e.length){break}yield e;n+=t}}function*M(e,t=2*1024*1024){let i=0;while(true){const a=e.slice(i,i+t);if(!a.size){break}yield n(a);i+=t}async function n(e){return new Uint8Array(await e.arrayBuffer())}}function F(e){return e instanceof Blob}function x(e){const t=new Date(e*1e3);function i(e){return e.toString().padStart(2,"0")}return t.getFullYear()+"."+i(t.getMonth()+1)+"."+i(t.getDate())+" "+i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())}function k(e,t=2){if(e===0){return"0 B"}const i=1024;t=t<0?0:t;const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];const a=Math.floor(Math.log(e)/Math.log(i));return Number.parseFloat((e/Math.pow(i,a)).toFixed(t))+" "+n[a]}var N={created(){w.$on("input-changed",this.onInputChanged)},props:["hasher","input","settings"],methods:{onInputChanged(){this.newInput=true},async compute(){this.computing=true;this.time=0;this.progress=0;this.$forceUpdate();await new Promise(e=>setTimeout(e,16));let e;if(isString(this.input)){e=this.input}else{if(!this.hasher.binarySupported){return}if(F(this.input)){const t=performance.now();e=await this.input.arrayBuffer();this.loadingToMemoryTime=performance.now()-t}else{e=this.input;this.loadingToMemoryTime=this.settings.loadingToMemoryTime}this.$forceUpdate();await new Promise(e=>setTimeout(e,16))}const t=performance.now();this.hash=this.hasher.hash(e);this.progress=100;this.time=performance.now()-t;this.newInput=false;this.computing=false},async streamCompute(){this.computing=true;this.progress=0;await new Promise(e=>setTimeout(e,16));const e=this;this.loadingToMemoryTime=null;if(this.streamMode==="FileReader"){console.log(this.settings.readerChunkSize);await t(M(this.input,this.settings.readerChunkSize),this.input.size)}else if(this.streamMode==="ReadableStream"){await t(C(this.input.stream()),this.input.size)}else if(this.streamMode==="ArrayBuffer"){await t(I(this.input),this.input.byteLength)}this.newInput=false;this.computing=false;async function t(t,i){const n=new e.hasher;const a=performance.now();let r=a;let s=0;const o=e.settings;e.progress=0;for await(const a of t){if(o.animation){const t=performance.now();if(t-r>1e3/o.fps){r=t;e.progress=s/i*100;await new Promise(e=>S(e))}s+=a.length}n.update(a)}e.progress=100;e.hash=n.finalize();e.time=performance.now()-a}}},data(){return{hash:"",time:"",progress:0,loadingToMemoryTime:null,newInput:true,computing:false}},computed:{streamMethodMessage(){if(this.streamMode==="ArrayBuffer"){return"Iterate ArrayBuffer chunks of the file loaded in the memory"}if(this.streamMode==="FileReader"){return"Stream reading of the file via FileReader"}if(this.streamMode==="ReadableStream"){return"Stream reading of the file via ReadableStream"}},unsupportedStreamMethodMessage(){if(!this.hasher.updateSupported){return"Does not support `update` method"}if(this.streamMode==="String"){return"I see no sense to use progressive hashing for the text input"}},inputIsString(){return isString(this.input)},totalTime(){if(this.loadingToMemoryTime&&this.time){return(Number(this.time)+Number(this.loadingToMemoryTime)).toFixed(2)}else{return null}},streamMode(){if(isArrayBuffer(this.input)){return"ArrayBuffer"}else if(F(this.input)){if(this.settings.streamType==="FileReader"){return"FileReader"}if(this.settings.streamType==="ReadableStream"){return"ReadableStream"}}return"String"}},components:{FormattedNumber:b}};const B=N;var A=function(){var e=this;var t=e.$createElement;var i=e._self._c||t;return i("div",{staticClass:"hasher-item-component",class:e.computing?"computing":null},[i("div",{staticClass:"top"},[i("div",{staticClass:"progress-line",style:{width:e.progress+"%"}}),e._v(" "),i("div",{staticClass:"name"},[e._v(e._s(e.hasher.githubName))]),e._v(" "),i("div",{staticClass:"compute-buttons"},[i("button",{attrs:{disabled:!e.hasher.binarySupported&&!e.inputIsString||e.input===null,title:(!e.hasher.binarySupported?"Does not support ArrayBuffer":null)||(e.input===null?"No selected file":"Compute the hash without data splitting (the whole file will be loaded to memory)")},on:{click:e.compute}},[e._v("Compute\n      ")]),e._v(" "),i("button",{attrs:{disabled:!e.hasher.updateSupported||e.streamMode==="String"||e.settings.readerChunkSize<1,title:e.unsupportedStreamMethodMessage||e.streamMethodMessage},on:{click:e.streamCompute}},[e._v("Stream Compute\n      ")])])]),e._v(" "),i("div",{staticClass:"middle",style:{opacity:e.newInput||!e.time?"0.2":"1"}},[i("div",{staticClass:"hash-times"},[i("div",{staticClass:"hash-time",attrs:{title:"Hashing time"}},[e.time?i("span",[i("FormattedNumber",{attrs:{number:e.time}}),e._v(" ms")],1):e._e()]),e._v(" "),i("div",{staticClass:"file-loading-time",attrs:{title:"Loading to memory time"}},[e.loadingToMemoryTime?i("span",[i("FormattedNumber",{attrs:{number:e.loadingToMemoryTime}}),e._v(" ms")],1):e._e()]),e._v(" "),i("div",{staticClass:"total-hash-time",attrs:{title:"Total time"}},[e.totalTime?i("div",[i("FormattedNumber",{attrs:{number:e.totalTime}}),e._v(" ms")],1):e._e()])])]),e._v(" "),i("div",{staticClass:"bottom"},[i("div",{staticClass:"hash",style:{color:e.newInput?"#ddd":"#000",opacity:e.hash?1:0}},[e._v(e._s(e.hash))])])])};var R=[];A._withStripped=true;const z=undefined;const D="data-v-1e637de0";const $=undefined;const P=false;const E=a({render:A,staticRenderFns:R},z,B,D,P,$,false,undefined,undefined,undefined);var L={props:["file"],data(){return{dropHover:false}},methods:{secondsToFormattedString:x,bytesToSize:k,async handleFileData(e){this.$emit("file-input-change",e)},async onFileInputChange(e){const t=e.target;const i=t.files[0];await this.handleFileData(i);t.value=null},async onFileDrop(e){e.preventDefault();setTimeout(e=>this.dropHover=false,50);const t=e.dataTransfer.files[0];await this.handleFileData(t)},onFileDragEnter(){setTimeout(e=>this.dropHover=true,0)},onFileDragLeave(){this.dropHover=false},onFileDragOver(e){e.preventDefault();e.dataTransfer.dropEffect="copy"},disableDragOverNonThisComponent(){document.querySelector("body").addEventListener("dragover",e=>{if(!this.$el.contains(e.target)){e.preventDefault();e.dataTransfer.dropEffect="none"}})}},mounted(){this.disableDragOverNonThisComponent()},components:{"formatted-number":b}};const q=L;var H=function(){var e=this;var t=e.$createElement;var i=e._self._c||t;return i("div",{staticClass:"file-input-drag-n-drop-component",class:{"drop-hover":e.dropHover},on:{drop:e.onFileDrop,dragenter:e.onFileDragEnter,dragleave:e.onFileDragLeave,dragover:e.onFileDragOver}},[i("label",{staticStyle:{width:"100%",height:"100%"},attrs:{for:"file-input"}},[!e.file?i("div",{attrs:{id:"add-files-button"}},[e._t("default",[e._v("Select file")])],2):e._e(),e._v(" "),i("input",{staticStyle:{display:"none"},attrs:{id:"file-input",type:"file",accept:"*/*"},on:{change:e.onFileInputChange}}),e._v(" "),i("div",{staticClass:"file-info"},[e.file?i("div",{staticClass:"file-name",attrs:{title:e.file.name}},[e._v(e._s(e.file.name))]):e._e(),e._v(" "),e.file?i("div",{staticClass:"file-size"},[e._v(e._s(e.bytesToSize(e.file.size)))]):e._e(),e._v(" "),e.file?i("div",{staticClass:"file-mtime"},[e._v(e._s(e.secondsToFormattedString(e.file.lastModified/1e3)))]):e._e()])])])};var O=[];H._withStripped=true;const U=undefined;const V="data-v-2b87d06f";const j=undefined;const X=false;const Y=a({render:H,staticRenderFns:O},U,q,V,X,j,false,undefined,undefined,undefined);var G={name:"MainContainer",components:{HasherItem:E,FileInputDragNDrop:Y,FormattedNumber:b},data(){return{inputText:"",inputFile:null,inputBinary:null,storeInMemory:false,binaryLoading:false,loadingToMemoryTime:0,streamType:"FileReader",animation:true,fps:25,readerChunkSizeMB:2,activeInputType:"text",activeInputTypeAutoSwitcher:true}},computed:{inputByteSize(){if(this.activeInputType==="text"){return(new TextEncoder).encode(this.inputText).byteLength}if(this.activeInputType==="file"&&this.inputFile){return this.inputFile.size}return 0},hashers(){const e=[];for(const t of Object.values(MD5)){e.push(t)}return e},input(){if(this.activeInputType==="file"){return this.inputBinary||this.inputFile}else if(this.activeInputType==="text"){return this.inputText}},readerChunkSize(){return Math.trunc(Number(this.readerChunkSizeMB)*1024*1024)}},watch:{inputFile(){if(this.activeInputTypeAutoSwitcher){this.activeInputType="file"}w.$emit("input-changed");this.updateInputBinary()},inputText(){if(this.activeInputTypeAutoSwitcher){this.activeInputType="text"}w.$emit("input-changed")},activeInputType(){w.$emit("input-changed")},storeInMemory(){this.updateInputBinary()}},methods:{async computeAll(){w.$emit("input-changed");for(const e of this.$refs.items){await e.compute();await new Promise(e=>S(e))}},clearInputData(){this.inputFile=null;this.inputBinary=null},clearInputText(){this.inputText=""},async onFileInputChange(e){this.inputFile=e},async updateInputBinary(){if(this.storeInMemory&&this.inputFile){this.loadingToMemoryTime=null;this.binaryLoading=true;const e=performance.now();this.inputBinary=await this.inputFile.arrayBuffer();this.loadingToMemoryTime=performance.now()-e;this.binaryLoading=false}else{this.inputBinary=null}}}};const K=G;var Z=function(){var e=this;var t=e.$createElement;var i=e._self._c||t;return i("div",{staticClass:"main-container-component"},[i("div",{staticClass:"inputs"},[i("div",{staticClass:"text-input"},[i("div",{staticClass:"textarea-wrapper",class:{"selected-input":e.activeInputType==="text"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputText,expression:"inputText"}],attrs:{placeholder:"Type a text here"},domProps:{value:e.inputText},on:{input:function(t){if(t.target.composing){return}e.inputText=t.target.value}}})])]),e._v(" "),i("div",{staticClass:"file-group"},[i("FileInputDragNDrop",{ref:"fileInputComponent",class:{"selected-input":e.activeInputType==="file"},attrs:{file:e.inputFile},on:{"file-input-change":e.onFileInputChange}}),e._v(" "),i("div",{staticClass:"settings",class:{inactive:e.activeInputType!=="file"}},[i("div",{staticClass:"store-in-memory"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.storeInMemory,expression:"storeInMemory"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.storeInMemory)?e._i(e.storeInMemory,null)>-1:e.storeInMemory},on:{change:function(t){var i=e.storeInMemory,n=t.target,a=n.checked?true:false;if(Array.isArray(i)){var r=null,s=e._i(i,r);if(n.checked){s<0&&(e.storeInMemory=i.concat([r]))}else{s>-1&&(e.storeInMemory=i.slice(0,s).concat(i.slice(s+1)))}}else{e.storeInMemory=a}}}}),e._v(" Store in memory "+e._s(e.binaryLoading?" (loadings...)":"")+"\n            "),e.loadingToMemoryTime&&e.storeInMemory&&e.inputBinary!==null?i("span",{attrs:{title:"loaded in"}},[e._v("("),i("FormattedNumber",{attrs:{number:e.loadingToMemoryTime}}),e._v(" ms)")],1):e._e()])]),e._v(" "),i("div",{staticClass:"stream-type"},[i("div",{style:{opacity:e.storeInMemory?.5:1}},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.streamType,expression:"streamType"}],attrs:{type:"radio",name:"streamType",value:"FileReader"},domProps:{checked:e._q(e.streamType,"FileReader")},on:{change:function(t){e.streamType="FileReader"}}}),e._v(" FileReader")]),e._v(" "),i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.streamType,expression:"streamType"}],attrs:{type:"radio",name:"streamType",value:"ReadableStream"},domProps:{checked:e._q(e.streamType,"ReadableStream")},on:{change:function(t){e.streamType="ReadableStream"}}}),e._v(" ReadableStream")])]),e._v(" "),i("label",{style:{opacity:e.streamType==="ReadableStream"&&!e.storeInMemory?.5:1},attrs:{title:"Chunk size for progressive hashing, Megabytes"}},[e._v("Chunk size, MB\n            "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.readerChunkSizeMB,expression:"readerChunkSizeMB"}],class:{invalid:e.readerChunkSize<1},attrs:{type:"number",min:"0.1",step:"0.1",title:e.readerChunkSize>0?"":"Value must be greater than or equal to 1 byte"},domProps:{value:e.readerChunkSizeMB},on:{input:function(t){if(t.target.composing){return}e.readerChunkSizeMB=t.target.value}}})])]),e._v(" "),i("div",{staticClass:"animation"},[i("span",{staticClass:"checkbox"},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.animation,expression:"animation"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.animation)?e._i(e.animation,null)>-1:e.animation},on:{change:function(t){var i=e.animation,n=t.target,a=n.checked?true:false;if(Array.isArray(i)){var r=null,s=e._i(i,r);if(n.checked){s<0&&(e.animation=i.concat([r]))}else{s>-1&&(e.animation=i.slice(0,s).concat(i.slice(s+1)))}}else{e.animation=a}}}}),e._v(" Animation, ")])]),e._v(" "),i("span",{staticClass:"fps",style:{opacity:e.animation?1:.5}},[i("label",[e._v("FPS "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.fps,expression:"fps"}],attrs:{type:"number"},domProps:{value:e.fps},on:{input:function(t){if(t.target.composing){return}e.fps=t.target.value}}})])])])])],1)]),e._v(" "),i("div",{staticClass:"input-switch"},[i("div",{staticClass:"switch-line"},[e._v("\n      Input:\n      "),i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.activeInputType,expression:"activeInputType"}],attrs:{type:"radio",name:"input",value:"text"},domProps:{checked:e._q(e.activeInputType,"text")},on:{change:function(t){e.activeInputType="text"}}}),e._v(" Text")]),e._v(" "),i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.activeInputType,expression:"activeInputType"}],attrs:{type:"radio",name:"input",value:"file"},domProps:{checked:e._q(e.activeInputType,"file")},on:{change:function(t){e.activeInputType="file"}}}),e._v(" File")]),e._v(" "),i("label",{staticClass:"input-switch-checkbox",attrs:{title:"Switch the input type automatically based on the corresponding input change"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.activeInputTypeAutoSwitcher,expression:"activeInputTypeAutoSwitcher"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.activeInputTypeAutoSwitcher)?e._i(e.activeInputTypeAutoSwitcher,null)>-1:e.activeInputTypeAutoSwitcher},on:{change:function(t){var i=e.activeInputTypeAutoSwitcher,n=t.target,a=n.checked?true:false;if(Array.isArray(i)){var r=null,s=e._i(i,r);if(n.checked){s<0&&(e.activeInputTypeAutoSwitcher=i.concat([r]))}else{s>-1&&(e.activeInputTypeAutoSwitcher=i.slice(0,s).concat(i.slice(s+1)))}}else{e.activeInputTypeAutoSwitcher=a}}}}),e._v(" Auto-Switch")])]),e._v(" "),i("div",{staticClass:"input-info"},[e._v("Input size:\n      "),e.activeInputType==="file"&&e.inputFile===null?i("span",{staticClass:"red"},[e._v("no file selected")]):i("span",[i("formatted-number",{attrs:{number:e.inputByteSize}}),e._v(" bytes")],1)])]),e._v(" "),i("div",{staticClass:"items"},e._l(e.hashers,(function(t,n){return i("HasherItem",{key:n,ref:"items",refInFor:true,attrs:{hasher:t,input:e.input,settings:{fps:e.fps,animation:e.animation,readerChunkSize:e.readerChunkSize,streamType:e.streamType,loadingToMemoryTime:e.loadingToMemoryTime}}})})),1),e._v(" "),i("div",{staticClass:"interface"},[i("button",{on:{click:e.computeAll}},[e._v("Compute all")])])])};var J=[];Z._withStripped=true;const Q=undefined;const W="data-v-51d8afa4";const ee=undefined;const te=false;const ie=a({render:Z,staticRenderFns:J},Q,K,W,te,ee,false,undefined,undefined,undefined);new i["default"]({render:e=>e(ie)}).$mount("#app")})(Vue);
//# sourceMappingURL=index.min.js.map